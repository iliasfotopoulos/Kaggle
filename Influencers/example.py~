from sklearn import linear_model
from sklearn import metrics
import numpy as np
import load_data

X_train_A, X_train_B, y_train = load_data.load("train")
X_test_A, X_test_B = load_data.load("test")

#Preprocess
def transform_features(x):
	return np.log(1+x)

X_train = transform_features(X_train_A) - transform_features(X_train_B)
model = linear_model.LogisticRegression(fit_intercept=False)
model.fit(X_train,y_train)

preds = model.predict_proba(X_train_A)
print preds
fpr, tpr, _ = metrics.roc_curve(y_test, preds)

#print model.score(X_train,y_train)
#p_train = model.predict_proba(X_train)
#print p_train
#p_train = p_train[:,1:2]
#print 'AuC score on training data:',roc_auc_score(y_train,p_train.T)